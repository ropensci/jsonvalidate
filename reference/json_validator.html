<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a json validator — json_validator • jsonvalidate</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create a json validator — json_validator" />
<meta property="og:description" content="Create a validator that can validate multiple json files." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jsonvalidate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/jsonvalidate.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ropensci/jsonvalidate/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a json validator</h1>
    <small class="dont-index">Source: <a href='https://github.com/ropensci/jsonvalidate/blob/master/R/validate.R'><code>R/validate.R</code></a></small>
    <div class="hidden name"><code>json_validator.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create a validator that can validate multiple json files.</p>
    </div>

    <pre class="usage"><span class='fu'>json_validator</span><span class='op'>(</span><span class='va'>schema</span>, engine <span class='op'>=</span> <span class='st'>"imjv"</span>, reference <span class='op'>=</span> <span class='cn'>NULL</span>, strict <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>schema</th>
      <td><p>Contents of the json schema, or a filename
containing a schema.</p></td>
    </tr>
    <tr>
      <th>engine</th>
      <td><p>Specify the validation engine to use.  Options are
"imjv" (the default; which uses "is-my-json-valid") and "ajv"
(Another JSON Schema Validator).  The latter supports more
recent json schema features.</p></td>
    </tr>
    <tr>
      <th>reference</th>
      <td><p>Reference within schema to use for validating against a
sub-schema instead of the full schema passed in. For example
if the schema has a 'definitions' list including a definition for a
'Hello' object, one could pass "#/definitions/Hello" and the validator
would check that the json is a valid "Hello" object. Only available if
<code>engine = "ajv"</code>.</p></td>
    </tr>
    <tr>
      <th>strict</th>
      <td><p>Set whether the schema should be parsed strictly or not.
If in strict mode schemas will error to "prevent any unexpected
behaviours or silently ignored mistakes in user schema". For example
it will error if encounters unknown formats or unknown keywords. See
https://ajv.js.org/strict-mode.html for details. Only available in
<code>engine = "ajv"</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="validation-engines"><a class="anchor" href="#validation-engines"></a>Validation Engines</h2>

    


<p>We support two different json validation engines, <code>imjv</code>
("is-my-json-valid") and <code>ajv</code> ("Another JSON
Validator"). <code>imjv</code> was the original validator included in
the package and remains the default for reasons of backward
compatibility. However, users are encouraged to migrate to
<code>ajv</code> as with it we support many more features, including
nested schemas that span multiple files, meta schema versions
later than draft-04, validating using a subschema, and
validating a subset of an input data object.</p>
<p>If your schema uses these features we will print a message to
screen indicating that you should update. We do not use a
warning here as this will be disruptive to users. You can
disable the message by setting the option
<code>jsonvalidate.no_note_imjv</code> to <code>TRUE</code>. Consider
using <code><a href='https://withr.r-lib.org/reference/with_options.html'>withr::with_options()</a></code> (or simply
<code><a href='https://rdrr.io/r/base/message.html'>suppressMessages()</a></code>) to scope this option if you want to
quieten it within code you do not control.</p>
<p>Updating the engine should be simply a case of adding <code>{engine = "ajv"</code> to your <code>json_validator</code> or <code>json_validate</code>
calls, but you may see some issues when doing so.</p><ul>
<li><p>Your json now fails validation: We've seen this where schemas
spanned several files and are silently ignored. By including
these, your data may now fail validation and you will need to
either fix the data or the schema.</p></li>
<li><p>Your code depended on the exact payload returned by <code>imjv</code>: If
you are inspecting the error result and checking numbers of
errors, or even the columns used to describe the errors, you
will likely need to update your code to accommodate the slightly
different format of <code>ajv</code></p></li>
<li><p>Your schema is simply invalid: If you reference an invalid
metaschema for example, jsonvalidate will fail</p></li>
</ul>

    <h2 class="hasAnchor" id="using-multiple-files"><a class="anchor" href="#using-multiple-files"></a>Using multiple files</h2>

    


<p>Multiple files are supported.  You can have a schema that
references a file <code>child.json</code> using <code>{"$ref": "child.json"}</code> -
in this case if <code>child.json</code> includes an <code>id</code> or <code>$id</code> element
it will be silently dropped and the filename used to reference
the schema will be used as the schema id.</p>
<p>The support is currently quite limited - it will not (yet) read
sub-child schemas relative to child schema <code>$id</code> url, and
does not support reading from URLs (only local files are
supported).</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># A simple schema example:</span>
<span class='va'>schema</span> <span class='op'>&lt;-</span> <span class='st'>'{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "title": "Product",
    "description": "A product from Acme\'s catalog",
    "type": "object",
    "properties": {
        "id": {
            "description": "The unique identifier for a product",
            "type": "integer"
        },
        "name": {
            "description": "Name of the product",
            "type": "string"
        },
        "price": {
            "type": "number",
            "minimum": 0,
            "exclusiveMinimum": true
        },
        "tags": {
            "type": "array",
            "items": {
                "type": "string"
            },
            "minItems": 1,
            "uniqueItems": true
        }
    },
    "required": ["id", "name", "price"]
}'</span>

<span class='co'># Create a validator function</span>
<span class='va'>v</span> <span class='op'>&lt;-</span> <span class='fu'>jsonvalidate</span><span class='fu'>::</span><span class='fu'>json_validator</span><span class='op'>(</span><span class='va'>schema</span><span class='op'>)</span>

<span class='co'># Test if some (invalid) json conforms to the schema</span>
<span class='fu'>v</span><span class='op'>(</span><span class='st'>"{}"</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] FALSE
#&gt; attr(,"errors")
#&gt;        field     message
#&gt; 1    data.id is required
#&gt; 2  data.name is required
#&gt; 3 data.price is required</div><div class='input'>
<span class='co'># Test if some (valid) json conforms to the schema</span>
<span class='fu'>v</span><span class='op'>(</span><span class='st'>'{
    "id": 1,
    "name": "A green door",
    "price": 12.50,
    "tags": ["home", "green"]
}'</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='co'># Using features from draft-06 or draft-07 requires the ajv engine:</span>
<span class='va'>schema</span> <span class='op'>&lt;-</span> <span class='st'>"{
  '$schema': 'http://json-schema.org/draft-06/schema#',
  'type': 'object',
  'properties': {
    'a': {
      'const': 'foo'
    }
  }
}"</span>

<span class='co'># Create the validator</span>
<span class='va'>v</span> <span class='op'>&lt;-</span> <span class='fu'>jsonvalidate</span><span class='fu'>::</span><span class='fu'>json_validator</span><span class='op'>(</span><span class='va'>schema</span>, engine <span class='op'>=</span> <span class='st'>"ajv"</span><span class='op'>)</span>

<span class='co'># This confirms to the schema</span>
<span class='fu'>v</span><span class='op'>(</span><span class='st'>'{"a": "foo"}'</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='co'># But this does not</span>
<span class='fu'>v</span><span class='op'>(</span><span class='st'>'{"a": "bar"}'</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] FALSE</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Rich FitzJohn, Rob Ashton.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


